<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Profile</title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
</head>
<body class="flex justify-center items-center min-h-screen bg-gray-100">
<div class="w-full max-w-md p-4">
  <h1 class="text-3xl font-bold text-orange-500 mb-6">
    Profile
  </h1>
  <div class="bg-pink-50 p-6 rounded-lg shadow-md text-center">
    <div class="relative">
      <img alt="Profile picture of a person" class="w-24 h-24 rounded-full mx-auto mb-4" height="100" src="https://storage.googleapis.com/a1aa/image/XQ-KXbpdI25b6mn--SeMtAQJANdK7semR9safjeTjss.jpg" width="100"/>
      <i id="editIcon" class="fas fa-pen text-orange-500 absolute top-0 right-0">
      </i>
    </div>
    <p class="text-sm text-gray-500">
      ID: <span th:text="${user.id}"></span>
    </p>
    <h2 class="text-2xl font-semibold mb-2">
      <span th:text="${user.name}"></span>
    </h2>
    <p class="text-orange-500 font-semibold mb-2">
      Diamond VIP
    </p>
    <p class="text-sm text-gray-500 mb-2">
      Male
    </p>
    <p class="text-sm text-gray-500 mb-2">
      21/09/2004
    </p>
    <p class="text-sm text-gray-500 mb-2">
      Address: <span th:text="${user.address}"></span>
    </p>
    <div class="flex items-center justify-center mb-2">
      <i class="fas fa-phone-alt text-black mr-2">
      </i>
      <p class="text-sm text-black">
        Tel: <span th:text="${user.phone}"></span>
      </p>
    </div>
    <div class="flex items-center justify-center">
      <i class="fas fa-envelope text-black mr-2">
      </i>
      <p class="text-sm text-black">
        Email: <span th:text="${user.email}"></span>
      </p>
    </div>
  </div>
  <div class="mt-6 text-center">
    <h3 class="text-lg font-semibold mb-2">
      Order and Transaction History
    </h3>
    <ul class="text-orange-500">
      <li class="mb-1">
        <a href="#">
          Recent Order
        </a>
      </li>
      <li class="mb-1">
        <a href="#">
          Purchase History
        </a>
      </li>
      <li>
        <a href="#">
          Payment History
        </a>
      </li>
    </ul>
  </div>
</div>
<div id="editModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
  <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
    <div class="mt-3 text-center">
      <h3 class="text-lg leading-6 font-medium text-gray-900">Edit Profile</h3>
      <div class="mt-2 px-7 py-3">
        <form th:action="@{/profile/update}" method="post" th:object="${user}">
          <input type="hidden" th:field="*{id}"/>
          <label for="name">Name:</label>
          <input id="name" type="text" th:field="*{name}" class="mb-3 px-3 py-2 border rounded-lg w-full">

          <label for="phone">Phone:</label>
          <input id="phone" type="text" th:field="*{phone}" class="mb-3 px-3 py-2 border rounded-lg w-full">

          <label for="address">Address:</label>
          <input id="address" type="text" th:field="*{address}" class="mb-3 px-3 py-2 border rounded-lg w-full">

          <button type="submit" class="px-4 py-2 bg-orange-500 text-white rounded-md">Save</button>
        </form>

        <p th:if="${successMessage}" th:text="${successMessage}" class="text-green-500"></p>

      </div>
      <div class="items-center px-4 py-3">
        <button id="saveBtn" class="px-4 py-2 bg-orange-500 text-white text-base font-medium rounded-md shadow-sm hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-orange-300">
          Save
        </button>
        <button id="closeBtn" class="ml-3 px-4 py-2 bg-gray-500 text-white text-base font-medium rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  // Lấy các phần tử DOM cần thiết
  const editIcon = document.getElementById('editIcon');
  const editModal = document.getElementById('editModal');
  const closeBtn = document.getElementById('closeBtn');
  const saveBtn = document.getElementById('saveBtn');

  const editName = document.getElementById('name');
  const editPhone = document.getElementById('phone');
  const editAddress = document.getElementById('address');

  const userName = document.querySelector('[th\\:text="${user.name}"]');
  const userPhone = document.querySelector('[th\\:text="${user.phone}"]');
  const userAddress = document.querySelector('[th\\:text="${user.address}"]');

  // Hiển thị modal khi nhấp vào biểu tượng chỉnh sửa
  editIcon.addEventListener('click', () => {
    editName.value = userName.innerText;
    editPhone.value = userPhone.innerText;
    editAddress.value = userAddress.innerText;
    editModal.classList.remove('hidden');
  });

  // Ẩn modal khi nhấp vào nút đóng
  closeBtn.addEventListener('click', () => {
    editModal.classList.add('hidden');
  });

  // Lưu thông tin và ẩn modal khi nhấp vào nút lưu
  saveBtn.addEventListener('click', () => {
    document.querySelector('form').submit();
  });
</script>
</body>
</html>
